<html>
<head>
    <meta charset="utf-8">
    <title>ECharts</title>
    <!-- 引入 echarts.js -->
    <script src="echarts.min.js"></script>
</head>
<body>
    <!-- 为ECharts准备一个具备大小（宽高）的Dom -->
    <div id="main" style="width: 1000px;height:400px;"></div>
    <script type="text/javascript">
        // 初始数据，接口返回
        const initData =[
            {
                "time":"2021-01-15 10:46:51",
                "name":'1.txt',
                "command":"mysqld",
                "value":[
                    {"pid":00000,"cpu":13.17,"mem":71.00},
                    {"pid":1392,"cpu":20.0,"mem":11.5},
                    {"pid":24454,"cpu":20.0,"mem":5.7},
                    {"pid":20355,"cpu":0.0,"mem":0.0},
                    {"pid":20409,"cpu":0.0,"mem":0.0},
                    {"pid":20411,"cpu":20.0,"mem":0.0},
                    {"pid":26932,"cpu":0.0,"mem":1.9}
                ]
            },
            {
                "time":"2021-01-15 10:46:58",
                "name":'1.txt',
                "command":"mysqld",
                "value":[
                    {"pid":00000,"cpu":10.18,"mem":71.00},
                    {"pid":1392,"cpu":20.0,"mem":11.5},
                    {"pid":24454,"cpu":20.0,"mem":5.7},
                    {"pid":20355,"cpu":0.0,"mem":0.0},
                    {"pid":20409,"cpu":0.0,"mem":0.0},
                    {"pid":20411,"cpu":20.0,"mem":0.0},
                    {"pid":26932,"cpu":0.0,"mem":1.9}
                ]
            },
            {
                "time":"2021-01-15 10:46:51",
                "name":'2.txt',
                "command":"mysqld",
                "value":[
                    {"pid":00000,"cpu":10.0,"mem":71.00},
                    {"pid":1392,"cpu":20.0,"mem":11.5},
                    {"pid":24454,"cpu":20.0,"mem":5.7},
                    {"pid":20355,"cpu":0.0,"mem":0.0},
                    {"pid":20409,"cpu":0.0,"mem":0.0},
                    {"pid":20411,"cpu":20.0,"mem":0.0},
                    {"pid":26932,"cpu":0.0,"mem":1.9}
                ]
            },
            {
                "time":"2021-01-15 10:46:59",
                "name":'2.txt',
                "command":"mysqld",
                "value":[
                    {"pid":00000,"cpu":15.17,"mem":71.00},
                    {"pid":1392,"cpu":20.0,"mem":11.5},
                    {"pid":24454,"cpu":20.0,"mem":5.7},
                    {"pid":20355,"cpu":0.0,"mem":0.0},
                    {"pid":20409,"cpu":0.0,"mem":0.0},
                    {"pid":20411,"cpu":20.0,"mem":0.0},
                    {"pid":26932,"cpu":0.0,"mem":1.9}
                ]
            },
            {
                "time":"2021-01-15 10:46:51",
                "name":'3.txt',
                "command":"mysqld",
                "value":[
                    {"pid":00000,"cpu":2.0,"mem":71.00},
                    {"pid":1392,"cpu":20.0,"mem":11.5},
                    {"pid":24454,"cpu":20.0,"mem":5.7},
                    {"pid":20355,"cpu":0.0,"mem":0.0},
                    {"pid":20409,"cpu":0.0,"mem":0.0},
                    {"pid":20411,"cpu":20.0,"mem":0.0},
                    {"pid":26932,"cpu":0.0,"mem":1.9}
                ]
            },
            {
                "time":"2021-01-15 10:46:59",
                "name":'3.txt',
                "command":"mysqld",
                "value":[
                    {"pid":00000,"cpu":5.17,"mem":71.00},
                    {"pid":1392,"cpu":20.0,"mem":11.5},
                    {"pid":24454,"cpu":20.0,"mem":5.7},
                    {"pid":20355,"cpu":0.0,"mem":0.0},
                    {"pid":20409,"cpu":0.0,"mem":0.0},
                    {"pid":20411,"cpu":20.0,"mem":0.0},
                    {"pid":26932,"cpu":0.0,"mem":1.9}
                ]
            },
            {
                "time":"2021-01-15 10:46:51",
                "name":'4.txt',
                "command":"mysqld",
                "value":[
                    {"pid":00000,"cpu":1.0,"mem":71.00},
                    {"pid":1392,"cpu":20.0,"mem":11.5},
                    {"pid":24454,"cpu":20.0,"mem":5.7},
                    {"pid":20355,"cpu":0.0,"mem":0.0},
                    {"pid":20409,"cpu":0.0,"mem":0.0},
                    {"pid":20411,"cpu":20.0,"mem":0.0},
                    {"pid":26932,"cpu":0.0,"mem":1.9}
                ]
            },
            {
                "time":"2021-01-15 10:46:59",
                "name":'4.txt',
                "command":"mysqld",
                "value":[
                    {"pid":00000,"cpu":1.17,"mem":71.00},
                    {"pid":1392,"cpu":20.0,"mem":11.5},
                    {"pid":24454,"cpu":20.0,"mem":5.7},
                    {"pid":20355,"cpu":0.0,"mem":0.0},
                    {"pid":20409,"cpu":0.0,"mem":0.0},
                    {"pid":20411,"cpu":20.0,"mem":0.0},
                    {"pid":26932,"cpu":0.0,"mem":1.9}
                ]
            },
            {
                "time":"2021-01-18 10:46:51",
                "name":'5.txt',
                "command":"mysqld",
                "value":[
                    {"pid":00000,"cpu":9.0,"mem":71.00},
                    {"pid":1392,"cpu":20.0,"mem":11.5},
                    {"pid":24454,"cpu":20.0,"mem":5.7},
                    {"pid":20355,"cpu":0.0,"mem":0.0},
                    {"pid":20409,"cpu":0.0,"mem":0.0},
                    {"pid":20411,"cpu":20.0,"mem":0.0},
                    {"pid":26932,"cpu":0.0,"mem":1.9}
                ]
            },
            {
                "time":"2021-01-19 10:30:59",
                "name":'5.txt',
                "command":"mysqld",
                "value":[
                    {"pid":00000,"cpu":12.17,"mem":71.00},
                    {"pid":1392,"cpu":20.0,"mem":11.5},
                    {"pid":24454,"cpu":20.0,"mem":5.7},
                    {"pid":20355,"cpu":0.0,"mem":0.0},
                    {"pid":20409,"cpu":0.0,"mem":0.0},
                    {"pid":20411,"cpu":20.0,"mem":0.0},
                    {"pid":26932,"cpu":0.0,"mem":1.9}
                ]
            },
        ]     

        // 所有文件名，已去重
        const nameList = Array.from(new Set(initData.map(d => d.name)))
        const resultData = []

        // 核心方法。 入参：文件名称，出参：符合要求的数据[time,cpu]
        const handleArr = (name)=>{
            const nameData = initData.filter(d => d.name === name)
            const arr = nameData.map(nd => {
                const time = nd.time
                const cpu = (nd.value || []).filter(n => n.pid === 0).map(d => d.cpu)
                return [time,cpu]
            })
            return arr
        }

        // 处理resultData
        nameList.forEach(name => {
            resultData.push({
                name: name,
                type: 'line',
                data: handleArr(name)
            })
        })

        // 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById('main'));

        // 指定图表的配置项和数据
        var option = {
            xAxis: {
                type: 'category',
            },
            legend: {
                data: resultData.map(item =>item.name)
            },
            yAxis: {
                type: 'value'
            },
            series: resultData
        };


        // 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);

    </script>
    <h2></h2>
</body>
</html>